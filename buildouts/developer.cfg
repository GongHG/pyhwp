[buildout]
extends = translator.cfg
develop+= pyhwp-tests
          tools/xsltest
          tools/gpl
          tools/constants
          tools/download
          tools/unpack
parts+= develop-tools
        test-core
	test-coverage
	test-cli
        test-xsl
	test-sdist
        test-tools
	test-for-bisect
        xsltest
	pylint
	pep8

[pyhwp]
eggs+= nose
       coverage
       gpl
       pyroma

[test-core]
recipe = collective.xmltestreport
eggs = pyhwp-tests
defaults = ['--auto-color', '--auto-progress', '--xml', '--tests-pattern=hwp5_tests']

[test-xsl]
recipe = collective.recipe.template
input = ${buildout:directory}/misc/test-xsl.in
output = ${buildout:directory}/bin/test-xsl
mode = 755

[test-coverage]
recipe = collective.recipe.template
input = ${buildout:directory}/misc/test-coverage
output = ${buildout:directory}/bin/test-coverage
mode = 755

[test-cli]
recipe = collective.recipe.template
input = ${buildout:directory}/misc/test-cli.in
output = ${buildout:directory}/bin/test-cli
mode = 755

[test-sdist]
recipe = collective.recipe.template
input = ${buildout:directory}/misc/test-sdist.in
output = ${buildout:directory}/bin/test-sdist
mode = 755

[test-tools]
recipe = collective.xmltestreport
eggs = gpl
defaults = ['--auto-color', '--auto-progress', '--xml']

[test-for-bisect]
recipe = collective.recipe.template
input = ${buildout:directory}/misc/test-for-bisect
output = ${buildout:directory}/bin/test-for-bisect
mode = 755

[xsltest]
recipe = zc.recipe.egg
eggs = xsltest

[pylint]
recipe = zc.recipe.egg
eggs = pylint
entry-points = pylint=pylint.lint:Run
arguments = sys.argv[1:]
extra-paths = ${buildout:directory}/pyhwp

[pep8]
recipe = zc.recipe.egg
eggs = pep8

[jxml]
location = ${buildout:parts-directory}/jxml
recipe = collective.recipe.cmd
cmds = mkdir -p ${:location}
       jython ${virtualenv-unpack:destination}/virtualenv.py ${:location}
       ${:location}/bin/jython ${buildout:directory}/tools/xsltest/setup.py develop
       ${:location}/bin/jython ${buildout:directory}/tools/jxml/setup.py develop
       ${:location}/bin/jython ${buildout:directory}/tools/jxml/lxml/setup.py develop
       ${:location}/bin/jython ${buildout:directory}/tools/jxml/jxml.coverage/setup.py develop
       ${buildout:bin-directory}/pyhwp-download http://mirror.apache-kr.org/xalan/xalan-j/binaries/xalan-j_2_7_1-bin-2jars.tar.gz ${buildout:parts-directory} 3ccda39bcd08b780436dfd2f22fb23d5
       ${buildout:bin-directory}/pyhwp-unpack ${buildout:parts-directory}/xalan-j_2_7_1-bin-2jars.tar.gz ${buildout:parts-directory}/xalan-j_2_7_1
uninstall_cmds = rm -rf ${:location}
on_install = true
on_update = true
xalan-j-dir = ${buildout:parts-directory}/xalan-j_2_7_1
xalan-j-jars = ${:xalan-j-dir}/xalan.jar:${:xalan-j-dir}/xercesImpl.jar:${:xalan-j-dir}/serializer.jar:${:xalan-j-dir}/xml-apis.jar

[virtualenv-unpack]
recipe = hexagonit.recipe.download
url = https://pypi.python.org/packages/source/v/virtualenv/virtualenv-1.9.1.tar.gz
destination = ${buildout:parts-directory}/virtualenv
strip-top-level-dir = true

[develop-tools]
recipe = zc.recipe.egg
eggs = pyhwp.develop.download
       pyhwp.develop.unpack
